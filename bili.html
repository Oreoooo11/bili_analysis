<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>B站视频数据分析</title>

  <!-- 修复资源加载：替换为稳定CDN -->
  <!-- Tailwind CSS（开发版，生产建议本地安装） -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Font Awesome 图标（修复CDN地址） -->
  <link
    href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"
    rel="stylesheet"
  />
  <!-- ECharts（国内镜像，解决超时） -->
  <script src="https://cdn.bootcdn.net/ajax/libs/echarts/5.4.3/echarts.min.js"></script>

  <!-- Tailwind 主题配置（保持原有风格） -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#FF729F',
            secondary: '#FFB6C1',
            accent: '#FFD1DC',
            bilibili: '#FB7299',
            dark: '#333333',
          },
        },
      },
    };
  </script>

  <style type="text/tailwindcss">
    /* 修复图表容器高度、开屏样式 */
    .chart-container {
      @apply w-full h-64;
    }

    /* 强制图表高度，避免空白 */
    #splash-screen {
      @apply fixed inset-0 z-50 flex items-center justify-center bg-white;
    }

    .splash-img {
      @apply w-full h-full object-cover;
    }

    /* 确保图片填充容器 */
  </style>
</head>

<body class="bg-gray-50 font-sans text-dark overflow-x-hidden">
  <!-- 顶部标签栏（新增，强化主题） -->
  <div class="bg-bilibili/10 py-2 text-center text-sm text-gray-700">
    B站视频数据分析平台 · 基于公开数据可视化
  </div>

  <!-- 开屏界面（修复图片路径，需替换为实际文件名） -->
  <div id="splash-screen">
    <!-- 
      替换为你的开屏图片（同目录下示例：splash.jpg）
      若图片在images文件夹：src="images/splash.jpg" 
    -->
    <img src="bg1.jpg" alt="B站开屏" class="splash-img" />
    <div class="absolute inset-0 bg-gradient-to-b from-transparent to-bilibili/20"></div>
    <div class="absolute text-center px-4">
      <h1 class="text-[clamp(1.5rem,4vw,3rem)] font-bold text-white text-shadow mb-4">
        B站视频数据分析
      </h1>
      <p class="text-[clamp(0.9rem,1.5vw,1.1rem)] text-white text-shadow max-w-2xl mx-auto">
        深入解析视频分区、互动数据与用户行为
      </p>
      <button
        id="enter-btn"
        class="mt-6 px-6 py-2 bg-bilibili text-white rounded-full font-medium 
               hover:bg-bilibili/90 transition-all transform hover:scale-105 shadow-lg"
      >
        开始探索 <i class="fa fa-arrow-down ml-2"></i>
      </button>
    </div>
  </div>

  <!-- 导航栏（修复定位，确保滚动响应） -->
  <nav id="navbar" class="fixed top-6 left-0 right-0 z-40 transition-all duration-300 bg-transparent">
    <div class="container mx-auto px-4 py-3 flex justify-between items-center">
      <div class="flex items-center">
        <i class="fa fa-play-circle text-bilibili text-2xl mr-2"></i>
        <span class="font-bold text-xl text-white text-shadow">B站数据分析平台</span>
      </div>
      <div class="hidden md:flex space-x-6">
        <a href="#partition" class="text-white hover:text-accent transition-colors">分区分析</a>
        <a href="#duration" class="text-white hover:text-accent transition-colors">时长互动</a>
        <a href="#upowners" class="text-white hover:text-accent transition-colors">UP主分析</a>
        <a href="#publish" class="text-white hover:text-accent transition-colors">发布时间</a>
        <a href="#interaction" class="text-white hover:text-accent transition-colors">互动分析</a>
        <a href="#tags" class="text-white hover:text-accent transition-colors">热门标签</a>
      </div>
      <button class="md:hidden text-white text-xl">
        <i class="fa fa-bars"></i>
      </button>
    </div>
  </nav>

  <!-- 主内容区（修复图表容器高度） -->
  <main class="pt-16">
    <!-- 头部横幅（背景图需替换，同目录示例：header-bg.jpg） -->
    <header class="relative h-[45vh] min-h-[300px] flex items-center">
      <img src="bg2.jpg" alt="B站背景" class="splash-img" />
      <div class="absolute inset-0 bg-gradient-to-r from-bilibili/40 to-black/30"></div>
      <div class="container mx-auto px-4 z-10">
        <h1 class="text-[clamp(1.2rem,2.5vw,2rem)] font-bold text-white mb-3 max-w-3xl">
          B站视频内容数据深度分析
        </h1>
        <p class="text-white/90 text-base max-w-2xl mb-6">
          通过多维度数据分析，揭示视频内容表现、用户互动行为与平台生态特征
        </p>
        <div class="flex flex-wrap gap-3">
          <div class="bg-white/10 backdrop-blur-sm px-4 py-2 rounded-lg">
            <p class="text-white/80 text-xs">总视频数</p>
            <p class="text-white text-xl font-bold">108</p>
          </div>
          <div class="bg-white/10 backdrop-blur-sm px-4 py-2 rounded-lg">
            <p class="text-white/80 text-xs">总播放量</p>
            <p class="text-white text-xl font-bold">1.2亿+</p>
          </div>
          <div class="bg-white/10 backdrop-blur-sm px-4 py-2 rounded-lg">
            <p class="text-white/80 text-xs">覆盖分区</p>
            <p class="text-white text-xl font-bold">36个</p>
          </div>
        </div>
      </div>
    </header>

    <!-- 主要内容（修复图表容器，统一使用chart-container类） -->
    <div class="container mx-auto px-4 py-12">
      <!-- 分区分析 -->
      <section id="partition" class="mb-16">
        <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6">
          <div>
            <h2 class="text-[clamp(1.2rem,2vw,1.75rem)] font-bold mb-2">视频分区分布分析</h2>
            <p class="text-gray-600 text-sm">各分区视频数量、平均播放量与时长对比</p>
          </div>
          <div class="mt-3 md:mt-0 bg-accent/30 px-3 py-1 rounded-full text-xs">
            <i class="fa fa-th-large text-bilibili mr-1"></i> 36个内容分区
          </div>
        </div>
        <div class="bg-white rounded-xl shadow-md p-4 card-hover">
          <div id="analysis1_分区分析" class="chart-container"></div>
        </div>
      </section>

      <!-- 时长与互动关系 -->
      <section id="duration" class="mb-16">
        <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6">
          <div>
            <h2 class="text-[clamp(1.2rem,2vw,1.75rem)] font-bold mb-2">视频时长与互动关系</h2>
            <p class="text-gray-600 text-sm">不同时长区间的播放量、点赞、弹幕与分享数据</p>
          </div>
          <div class="mt-3 md:mt-0 bg-accent/30 px-3 py-1 rounded-full text-xs">
            <i class="fa fa-clock-o text-bilibili mr-1"></i> 7个时长区间
          </div>
        </div>
        <div class="bg-white rounded-xl shadow-md p-4 card-hover">
          <div id="analysis2_相关性分析" class="chart-container"></div>
        </div>
      </section>

      <!-- 头部UP主分析 -->
      <section id="upowners" class="mb-16">
        <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6">
          <div>
            <h2 class="text-[clamp(1.2rem,2vw,1.75rem)] font-bold mb-2">头部UP主影响力分析</h2>
            <p class="text-gray-600 text-sm">视频数量、播放量与互动指标综合评估</p>
          </div>
          <div class="mt-3 md:mt-0 bg-accent/30 px-3 py-1 rounded-full text-xs">
            <i class="fa fa-user-circle text-bilibili mr-1"></i> 10位头部创作者
          </div>
        </div>
        <div class="bg-white rounded-xl shadow-md p-4 card-hover">
          <div id="analysis3_发布时间分析" class="chart-container"></div>
        </div>
      </section>

      <!-- 发布时间分析 -->
      <section id="publish" class="mb-16">
        <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6">
          <div>
            <h2 class="text-[clamp(1.2rem,2vw,1.75rem)] font-bold mb-2">视频发布时间分析</h2>
            <p class="text-gray-600 text-sm">不同时段发布的视频数量与播放效果对比</p>
          </div>
          <div class="mt-3 md:mt-0 bg-accent/30 px-3 py-1 rounded-full text-xs">
            <i class="fa fa-calendar text-bilibili mr-1"></i> 时段与星期分布
          </div>
        </div>
        <div class="bg-white rounded-xl shadow-md p-4 card-hover">
          <div id="analysis4_头部UP主分析" class="chart-container"></div>
        </div>
      </section>

      <!-- 互动指标相关性 -->
      <section id="interaction" class="mb-16">
        <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6">
          <div>
            <h2 class="text-[clamp(1.2rem,2vw,1.75rem)] font-bold mb-2">互动指标相关性分析</h2>
            <p class="text-gray-600 text-sm">播放量、点赞、弹幕等互动数据的关联程度</p>
          </div>
          <div class="mt-3 md:mt-0 bg-accent/30 px-3 py-1 rounded-full text-xs">
            <i class="fa fa-bar-chart text-bilibili mr-1"></i> 6项核心指标
          </div>
        </div>
        <div class="bg-white rounded-xl shadow-md p-4 card-hover">
          <div id="analysis5_时长互动分析" class="chart-container"></div>
        </div>
      </section>

      <!-- 热门标签词云 -->
      <section id="tags" class="mb-16">
        <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6">
          <div>
            <h2 class="text-[clamp(1.2rem,2vw,1.75rem)] font-bold mb-2">热门视频标签词云</h2>
            <p class="text-gray-600 text-sm">高频出现的视频标签与关键词可视化</p>
          </div>
          <div class="mt-3 md:mt-0 bg-accent/30 px-3 py-1 rounded-full text-xs">
            <i class="fa fa-tags text-bilibili mr-1"></i> 热门关键词分析
          </div>
        </div>
        <div class="bg-white rounded-xl shadow-md p-4 card-hover">
          <div id="analysis6_标签词云" class="chart-container"></div>
        </div>
      </section>
    </div>
  </main>

  <!-- 页脚（强化信息，修复布局） -->
  <footer class="bg-bilibili/10 py-10">
    <div class="container mx-auto px-4">
      <div class="flex flex-col md:flex-row justify-between items-center">
        <div class="mb-6 md:mb-0 text-center md:text-left">
          <div class="flex items-center justify-center md:justify-start">
            <i class="fa fa-play-circle text-bilibili text-2xl mr-2"></i>
            <span class="font-bold text-xl">B站数据分析平台</span>
          </div>
          <p class="text-gray-600 mt-2 max-w-md">
            本平台提供B站视频数据的多维度分析，帮助创作者了解内容表现与用户偏好，优化创作方向。
          </p>
        </div>
        <div class="flex flex-col items-center md:items-end">
          <div class="flex space-x-4 mb-4">
            <a href="#" class="text-gray-600 hover:text-bilibili transition-colors">
              <i class="fa fa-github text-xl"></i>
            </a>
            <a href="#" class="text-gray-600 hover:text-bilibili transition-colors">
              <i class="fa fa-twitter text-xl"></i>
            </a>
            <a href="#" class="text-gray-600 hover:text-bilibili transition-colors">
              <i class="fa fa-bilibili text-xl"></i>
            </a>
          </div>
          <p class="text-gray-500 text-sm">联系方式：contact@example.com</p>
        </div>
      </div>
      <div class="border-t border-gray-200 mt-8 pt-6 text-center text-gray-500 text-sm">
        © 2023 B站数据分析平台 | 数据来源：B站公开数据 | 仅供研究参考使用
      </div>
    </div>
  </footer>

  <!-- JavaScript（核心修复：ID匹配+完整数据） -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const splashScreen = document.getElementById('splash-screen');
      const enterBtn = document.getElementById('enter-btn');
      const navbar = document.getElementById('navbar');

      // 开屏动画
      enterBtn.addEventListener('click', () => {
        splashScreen.classList.add('opacity-0', 'pointer-events-none');
        splashScreen.style.transition = 'opacity 1s ease';
        document.body.style.overflow = 'auto';

        setTimeout(() => {
          navbar.classList.add('bg-white/90', 'shadow-md', 'backdrop-blur-sm');
          navbar.classList.remove('bg-transparent');
          navbar.querySelectorAll('a, span').forEach(elem => {
            elem.classList.remove('text-white', 'text-shadow');
            elem.classList.add('text-gray-800');
          });
        }, 500);
      });

      // 导航栏滚动响应
      window.addEventListener('scroll', () => {
        if (window.scrollY > 50 && !splashScreen.classList.contains('opacity-0')) {
          navbar.classList.add('bg-white/90', 'shadow-md', 'backdrop-blur-sm');
          navbar.classList.remove('bg-transparent');
          navbar.querySelectorAll('a, span').forEach(elem => {
            elem.classList.remove('text-white', 'text-shadow');
            elem.classList.add('text-gray-800');
          });
        } else if (window.scrollY <= 50 && !splashScreen.classList.contains('opacity-0')) {
          navbar.classList.remove('bg-white/90', 'shadow-md', 'backdrop-blur-sm');
          navbar.classList.add('bg-transparent');
          navbar.querySelectorAll('a, span').forEach(elem => {
            elem.classList.add('text-white', 'text-shadow');
            elem.classList.remove('text-gray-800');
          });
        }
      });

      // 平滑滚动
      document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', e => {
          e.preventDefault();
          const target = document.querySelector(anchor.getAttribute('href'));
          if (target) {
            window.scrollTo({ top: target.offsetTop - 70, behavior: 'smooth' });
          }
        });
      });

      // 初始化图表（关键修复：补全数据+ID匹配）
      initCharts();
    });

    // 图表初始化（含完整数据）
    function initCharts() {
      // 2. 图表主题（粉色系）
      const theme = {
        color: ['#FF729F', '#FF9EBB', '#FFB6C1', '#DDA0DD', '#C71585', '#DB7093'],
        tooltip: { backgroundColor: 'rgba(255,255,255,0.9)', borderColor: '#FFB6C1' },
        legend: { textStyle: { color: '#666' } },
        grid: { left: '3%', right: '4%', bottom: '5%', containLabel: true }
      };

      // 3. 初始化图表（ID严格匹配HTML容器）
      function initChart(id, option) {
        const dom = document.getElementById(id);
        if (!dom) {
          console.error(`未找到图表容器：${id}`);
          return;
        }
        const chart = echarts.init(dom, theme);

        // 处理可能的NaN数据
        if (option.series) {
          option.series.forEach(series => {
            if (series.data && Array.isArray(series.data)) {
              series.data = series.data.map(item => isNaN(item) ? 0 : item);
            }
          });
        }

        chart.setOption(option);
        window.addEventListener('resize', () => chart.resize());
        return chart;
      }

      // 使用fetch加载JSON文件
      fetch('bili_analysis_results.json')
        .then(response => response.json())
        .then(data => {
          // 绑定图表（ID与HTML完全一致）
          initChart('analysis1_分区分析', data.partition_analysis);
          initChart('analysis2_相关性分析', data.duration_interaction);
          initChart('analysis3_发布时间分析', data.top_up_owners);
          initChart('analysis4_头部UP主分析', data.publish_time_analysis);
          initChart('analysis5_时长互动分析', data.interaction_correlation);

          // 词云图单独处理
          const tagOption = JSON.parse(JSON.stringify(data.tag_cloud));
          const pinkColors = ['#FF729F', '#FF9EBB', '#FFB6C1', '#DDA0DD'];
          tagOption.series[0].textStyle.color = () => pinkColors[Math.floor(Math.random() * pinkColors.length)];
          initChart('analysis6_标签词云', tagOption);
        })
        .catch(error => console.error('Error loading JSON file:', error));
    }
  </script>
</body>

</html>
